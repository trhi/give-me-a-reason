<!DOCTYPE html>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<html lang="en-us">
  <head>
      
    <!-- define character encoding: utf-8 -->
    <meta charset="utf-8">
    
    <!-- Made a very tiny change just to test whether I understand the add commit chain of events..
    -->
    
   <!-- add metadata regarding keywords of project/site/button?
   <meta name="keywords" content="refugees welcome, refugee crisis, european union, germany, altruism, i help because, helping others"> 
    -->   
    
    <!-- define: to cater to needs of IE9 and IE8 
    and specify: google chrome frame should start if installed -->
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <!-- define responsive design: w3.css -->
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">

    <style>
    #givemeareasonbutton {
    width: 300px;
    height: 300px;
    border-radius: 50%;
    background-image: url(http://transit6.cargocollective.com/1/17/565866/10706491/give-me-a-reason-ms.png);
    background-repeat: no-repeat;
    border: none;
    cursor: pointer;
    }

    #givemeareasonbutton:disabled{
    opacity: 0.6;
    cursor: url(https://upload.wikimedia.org/wikipedia/commons/6/6f/Sun_symbol.svg), wait;
    }

    </style>   
    
    <title>Give Me a Reason
    </title>

  </head>
  <body>

      
       <audio id="help/">
              <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/a2.mp3" type="audio/mp3">
      Your browser does not support the audio element.
       </audio>
      
      <audio id="audio">
              <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/a2.mp3" type="audio/mp3">
      Your browser does not support the audio element.
       </audio>
       
      
      
      
       <audio id="subject/">
           <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/b2.mp3" type="audio/mp3">
         
       </audio>
       
       <audio id="verb/">
           <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/c2.mp3" type="audio/mp3">
         
       </audio>
       
       <audio id="object/">
           <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/d2.mp3" type="audio/mp3">
         
       </audio>
      
         <audio id="x/">
           <source src="https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/b2.mp3" type="audio/mp3">
         
       </audio>
       
       
      
      <form>
          <button type="button" id="givemeareasonbutton"
                
                  onclick="giveMeAReason()" ></button>
                  
     <!--implement this later: ondblclick="playAudio("x", 99, typeIndex[4])"-->
     
  </form>

      <p id="demo"></p>


      <script>
    
          //var persons is a global variable = array of the current voices recorded
          //var persons = ["k","h","t","f","s"];
          var persons = ["k","h","t","f","s"];
          //var audiopath gives the path at raw where you find all the files
          var audiopath = "https://raw.githubusercontent.com/trhi/trhi.github.io/randomise-draft-battle/audio/de/";
          //var mp3 for concatenation later on (need this be global? or just inside playAudio function?)
          var mp3 = ".mp3";
          //var ogg = ".ogg"; //implement for ogg too at some point?  
    
          //var typeIndex starts at 0 and gets +1 everytime we go through one playAudio()
          var typeIndex = 0; //global counter variable
          //var types is an array of the type of audio in question, this is used for 
          //concatenating the path of the audio source file later on
          //main purpose in this data structure solution is to create single 
          //playAudio() function ie. reuse code as much as possible.
          var types = ["help/", "subject/", "object/", "verb/"];
          // add element: "x/"?
    
          //toggles the button state = enabled or disabled depending on whether audio is playing
          //and the best part is that this function actually works! Hurray!
          function toggleButtonState(){
  
            if (document.getElementById("givemeareasonbutton").disabled === false) {
                document.getElementById("givemeareasonbutton").disabled = true;
            }else{
                 document.getElementById("givemeareasonbutton").disabled = false;
            }
    
}
          
          
          //changed name to randomIndex
          function randomIndex(min, max){
              
              //standard means to choose random number between max (excluded) and min (included)
              //max is exluded because max is given as the length of the array
              //and min is given as 0.
              //ie. if length = 2, there are indeces 0 and 1, not 0, 1 and 2.
              //ugh, except this mucks up the generating for the chooserandom index
              //for the recordings themselves..
              //ie. take care of the 0 array index issue in choosePerson()
              //return Math.floor(Math.random() * (max - min + 1)) + min;
              return Math.floor((Math.random() * max - min + 1) + min);
              
          }
          
          //chooses a person, ie. chooses random person from a list of persons
          function choosePerson(){
              
            // var persons is an array of strings..  
            //var persons = ["k","h","t","f","s"];
            //var randomIndex is an integer
            //function chooseIndex(min, max) generates a random number between max inclusive and min inclusive
            var index = randomIndex(1, persons.length);
            //to correct for random number generator
            var index = index - 1;
            return persons[index];
            
              
          }
     
    
          //generates a random help utterance given a person
          //each person has a different maximum number of utterances available
          //grr.. although I wanted each to have 8 and 8 only..
          //or should i call this by saying: persons[randomIndex]
          function chooseIndex(person){
              
              if(person.match(/k/)){
                  
                  return randomIndex(1,12);
                  //for testing print out value here
                 
              }
              if(person.match(/s/)){                  
                  return randomIndex(1,9);                  
              }
              
              if(person.match(/t/)){                  
                  return randomIndex(1,8);                  
              }
              if(person.match(/f/)){                  
                  return randomIndex(1,7);                  
              }
              if(person.match(/h/)){                  
                  return randomIndex(1,6);                  
              }
              
          }
 
    
          //creates a string version of the index (for later path concatenation
          function chooseStringIndex(person){
              
              var index = chooseIndex(person);
              if(index < 10){
                  
                  var zero = "0";
                  return zero.concat(index.toString()); 
                  
              }else{              
                  
                  return index.toString();
                  
              }
              
          }

            function createSource(typeIndex){
                
                  var person = choosePerson();
                  var index = chooseStringIndex(person);
            //      //does this way of calling it work?
                  var category = types[typeIndex].substring(0,1);
                  var filename = person.concat(index, category, mp3);
                  return audiosrc = audiopath.concat(types[typeIndex], filename);
            }
       
          
    function giveMeAReason(){
            
        //first, toggle button state: disable the button while audio is playing
       // toggleButtonState();  
       toggleButtonState();
        
      document.getElementById(types[typeIndex]).src = createSource(typeIndex);
      document.getElementById(types[typeIndex]).play();
      document.getElementById(types[typeIndex]).onended = function(){playSubject()};
        
        
        function playSubject(){
            document.getElementById(types[typeIndex+1]).src = createSource(typeIndex+1);
            document.getElementById(types[typeIndex+1]).play();
            document.getElementById(types[typeIndex+1]).onended = function(){playObject()};//wait until clip has finished playing before playing next clip

                    function playObject(){                            
                            document.getElementById(types[typeIndex+2]).src = createSource(typeIndex+2);
                            document.getElementById(types[typeIndex+2]).play();
                            document.getElementById(types[typeIndex+2]).onended = function(){playVerb()};
   
                                function playVerb(){
                                        document.getElementById(types[typeIndex+3]).src = createSource(typeIndex+3);
                                        document.getElementById(types[typeIndex+3]).play(); 
                                        document.getElementById(types[typeIndex+3]).onended = toggleButtonState();
                                }
                    }
        }                           
    }


    


    
    </script>
      
    <!--  
      <script>
      
      "GiveMeAReason()"
                  function "GiveMeAReason()"{
                      //this is where you assign the path for the audio element. for the sake of this trial, just use a1
        var reasonPath = "https://raw.githubusercontent.com/trhi/trhi.github.io/master/MP3/a1.mp3";              

                      document.getElementById(reason).src = reasonPath;
                      document.getElementById(reason).play();
          }
  </script>
        -->
    
    
    <!-- cope with screen rotations and scaling-->
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
